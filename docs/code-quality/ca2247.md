---
title: 'CA2247: O argumento passado para o construtor TaskCompletionSource deve ser a enumeração TaskCreationOptions em vez da enumeração TaskContinuationOptions'
ms.date: 05/16/2020
ms.topic: reference
f1_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
helpviewer_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
author: stephentoub
ms.author: stoub
manager: jeffhand
ms.workload:
- multiple
ms.openlocfilehash: 9931a68a82e40f8d5980e16588840a5e51cd7d03
ms.sourcegitcommit: a18c7e9b367c2f92f6e54c3eaef442775d457667
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90095429"
---
# <a name="ca2247-argument-passed-to-taskcompletionsource-constructor-should-be-taskcreationoptions-enum-instead-of-taskcontinuationoptions-enum"></a>CA2247: O argumento passado para o construtor TaskCompletionSource deve ser a enumeração TaskCreationOptions em vez da enumeração TaskContinuationOptions

|Item|Valor|
|-|-|
|RuleId|CA2247|
|Categoria|Microsoft. Usage|
|Alteração significativa|Sem interrupção|

## <a name="cause"></a>Causa

Construir um `System.Threading.Tasks.TaskCompletionSource` com um <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeração em vez de um <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor de enumeração.
Usando o <xref:System.Object.ReferenceEquals%2A?displayProperty=fullName> método para testar um ou mais tipos de valor para igualdade.

## <a name="rule-description"></a>Descrição da regra

O tipo TaskCompletionSource tem um construtor que aceita um <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor de enumeração e outro construtor que aceita um <xref:System.Object> .  Passar acidentalmente um <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeração em vez de um <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor de enumeração resultará na chamada do <xref:System.Object> Construtor baseado em: ele será compilado e executado, mas não terá o comportamento pretendido.

## <a name="how-to-fix-violations"></a>Como corrigir violações

Para corrigir a violação, substitua o <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeração pelo <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor de enumeração correspondente.

```csharp
    // Violation
    var tcs = new TaskCompletionSource<int>(TaskContinuationOptions.RunContinuationsAsynchronously);

    // Fixed
    var tcs = new TaskCompletionSource<int>(TaskCreationOptions.RunContinuationsAsynchronously);
```

## <a name="when-to-suppress-warnings"></a>Quando suprimir avisos

Uma violação dessa regra quase sempre realça um bug no código de chamada, de modo que o código não se comporte como o desenvolvedor pretendido, com a TaskCompletionSource efetivamente ignorando a opção especificada.  A única vez em que é seguro suprimir o aviso é se o desenvolvedor realmente pretendia passar um Boxed <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> como o argumento de estado do objeto para o TaskCompletionSource.

## <a name="see-also"></a>Confira também

- [Avisos de uso](../code-quality/usage-warnings.md)
