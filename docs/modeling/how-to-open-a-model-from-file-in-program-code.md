---
title: Como abrir um modelo a partir de um arquivo no código do programa
description: Saiba que o ModelBus fornece mecanismo padrão para referenciar um modelo ou elementos em um modelo e para localizar o modelo se ele foi movido.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 97de2d7e79dc44ff785663c4d04dc65851430472
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112387054"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Como abrir um modelo a partir de um arquivo no código do programa

Você pode abrir modelos DSL em qualquer aplicativo.

Em uma Visual Studio, você pode usar ModelBus para essa finalidade. ModelBus fornece mecanismo padrão para referenciar um modelo ou elementos em um modelo e para localizar o modelo se ele foi movido. Para obter mais informações, [consulte Integrando modelos usando Visual Studio Modelbus](../modeling/integrating-models-by-using-visual-studio-modelbus.md).

## <a name="target-framework"></a>Estrutura de destino

De definir **a Estrutura de destino** do seu projeto de aplicativo como .NET Framework 4 ou posterior.

1. Abra o Visual Studio para o aplicativo no qual você deseja ler um modelo DSL.

2. No **Gerenciador de Soluções**, clique com o botão direito do mouse no projeto e clique em **Propriedades**.

3. Na janela propriedades do projeto, na **guia** Aplicativo, de definido o campo Estrutura **de** destino como **.NET Framework 4** (ou posterior).

> [!NOTE]
> A estrutura de destino não deve ser **.NET Framework perfil de cliente 4.**

## <a name="references"></a>Referências

Adicione essas referências ao seu projeto Visual Studio aplicativo:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - Se você não vir isso na guia  **.NET** na caixa  de diálogo Adicionar Referências, clique na guia Procurar e navegue até `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\` .

- O assembly DSL, que você encontrará na pasta bin do projeto DSL. Seu nome normalmente é do formato: *YourCompany*. *SeuProjeto* `.Dsl.dll` .

## <a name="important-classes-in-the-dsl"></a>Classes importantes na DSL

Antes de escrever o código que lê sua DSL, você deve saber os nomes de algumas das classes geradas por sua DSL. Em sua solução DSL, abra o **projeto Dsl** e procure na **pasta GeneratedCode.** Como alternativa, clique duas vezes no assembly DSL no projeto Referências e abra o namespace DSL no **Pesquisador de Objetos**.

Estas são as classes que você deve identificar:

- *YourDslRootClass* – esse é o nome da classe raiz em seu `DslDefinition.dsl` .

- *YourDslName* `SerializationHelper` - Essa classe é definida em `SerializationHelper.cs` em seu projeto DSL.

- *YourDslName* `DomainModel` - Essa classe é definida em `DomainModel.cs` em seu projeto DSL.

## <a name="read-from-a-file"></a>Ler de um arquivo

O exemplo a seguir foi projetado para ler uma DSL na qual as classes importantes são as seguintes:

- FamilyTreeModel

- FamilyTreeSerializationHelper

- FamilyTreeDomainModel

A outra classe de domínio nessa DSL é Person.

```csharp
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="save-to-a-file"></a>Salvar em um arquivo

A adição a seguir ao código anterior faz uma alteração no modelo e, em seguida, salva-o em um arquivo.

```csharp
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```
